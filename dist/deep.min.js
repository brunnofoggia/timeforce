import _ from"lodash";var Deep={join:function(e){var t={};for(let i in e){let n=e[i];if(_.isObject(n)&&_.size(n)){var r=_.isObject(n)?join(n,i):_.pick(e,i);t=_.defaultsDeep(t,r)}else t[i]=n}return t}},join=function(e,t){var r={};if(_.isPlainObject(e)||_.isArray(e))for(let i in e){let n=e[i],s=join(n,[t,i].join("."));r=_.defaultsDeep(r,s)}else r[t]=e;return r};Deep.split=function(e){var t={};for(let i in e){let n=e[i];var r=split(n,i.split("."));t=_.defaultsDeep(t,r)}return t};var split=function(e,t,r={}){let i=t.shift();if(t.length>0){let n=t[0],s=/^[0-9]+$/.test(n);r[i]=split(e,t,s?[]:{})}else r[i]=e;return r};Deep.trail=function(e,t=!1){var r=[],i=[],n=e.split(".");for(let e in n){let s=n[e],l=parseInt(e,10)>0?r[parseInt(e,10)-1]:null,a=l?[l,s].join("."):s;r.push(a),t&&/\.[0-9]+\./.test(a)&&i.push(a.replace(/(\.)[0-9]+(\.)/g,".."))}return t&&(r=_.concat(i,r)),r},Deep.search=function(e,t,r){var i=r,n=(t+="").split(/\.\./g);if(2===n.length)i=[],_.each(n,(t=>{if(e){if(_.isArray(e))return _.each(e,((r,n)=>{var s=parseInt(n,10)+1;e.length;if(void 0===r)return i.push(SyntaxError);let l=Deep.search(r,t);i.push(l)}));e=Deep.search(e,t)}}));else{n=t.split(/\./g);let r=e;_.each(n,(e=>{try{r=r[e]}catch(e){r=void 0}})),void 0!==r&&(i=r)}return i},Deep.set=function(e,t,r){var i=Deep.join(t),n={};for(var s in i){let t=i[s];n=set(_.size(n)?n:e,s.split("."),t,r)}return n};var set=function(e,t,r,i={}){let n=t.shift();if(t.length>0){let s=t[0],l=/^[0-9]+$/.test(s),a=_.isArray(e[n]),p=!i.unset||t.length>1?e[n]:_.omit(e[n],s),o=set(p||(l?[]:{}),t,r,i);e[n]=_.defaultsDeep(o,p),a&&(e[n]=_.toArray(e[n]))}else i.unset?e=_.omit(e,n):e[n]=r;return e};export default Deep;